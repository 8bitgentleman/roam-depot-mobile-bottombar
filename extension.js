var t={853:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=(t,e)=>{const o=new MutationObserver(t);return o.observe(e,{childList:!0,subtree:!0}),o}},122:(t,e,o)=>{const n=o(655).__importDefault(o(853));e.Z=t=>(0,n.default)(t,document.getElementsByClassName("roam-body")[0])},890:(t,e,o)=>{const n=o(655).__importDefault(o(105));e.Z=t=>t?(0,n.default)(t.id):{blockUid:"",windowId:""}},105:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=t=>{var e;return t?{blockUid:t.substring(t.length-9,t.length),windowId:(null===(e=t.substring(0,t.length-10).match(/^block-input-([a-zA-Z0-9_-]+)$/))||void 0===e?void 0:e[1])||""}:{blockUid:"",windowId:""}}},655:(t,e,o)=>{o.r(e),o.d(e,{__assign:()=>a,__asyncDelegator:()=>_,__asyncGenerator:()=>v,__asyncValues:()=>k,__await:()=>w,__awaiter:()=>s,__classPrivateFieldGet:()=>x,__classPrivateFieldIn:()=>S,__classPrivateFieldSet:()=>I,__createBinding:()=>f,__decorate:()=>c,__exportStar:()=>p,__extends:()=>r,__generator:()=>d,__importDefault:()=>P,__importStar:()=>B,__makeTemplateObject:()=>O,__metadata:()=>u,__param:()=>i,__read:()=>m,__rest:()=>l,__spread:()=>h,__spreadArray:()=>g,__spreadArrays:()=>y,__values:()=>b});var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},n(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}var a=function(){return a=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},a.apply(this,arguments)};function l(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(o[n[r]]=t[n[r]])}return o}function c(t,e,o,n){var r,a=arguments.length,l=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(l=(a<3?r(l):a>3?r(e,o,l):r(e,o))||l);return a>3&&l&&Object.defineProperty(e,o,l),l}function i(t,e){return function(o,n){e(o,n,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function s(t,e,o,n){return new(o||(o=Promise))((function(r,a){function l(t){try{i(n.next(t))}catch(t){a(t)}}function c(t){try{i(n.throw(t))}catch(t){a(t)}}function i(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(l,c)}i((n=n.apply(t,e||[])).next())}))}function d(t,e){var o,n,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,n=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((r=(r=l.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){l.label=a[1];break}if(6===a[0]&&l.label<r[1]){l.label=r[1],r=a;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(a);break}r[2]&&l.ops.pop(),l.trys.pop();continue}a=e.call(t,l)}catch(t){a=[6,t],n=0}finally{o=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var f=Object.create?function(t,e,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(e,o);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,n,r)}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]};function p(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||f(e,t,o)}function b(t){var e="function"==typeof Symbol&&Symbol.iterator,o=e&&t[e],n=0;if(o)return o.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var n,r,a=o.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)l.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return l}function h(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(m(arguments[e]));return t}function y(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),r=0;for(e=0;e<o;e++)for(var a=arguments[e],l=0,c=a.length;l<c;l++,r++)n[r]=a[l];return n}function g(t,e,o){if(o||2===arguments.length)for(var n,r=0,a=e.length;r<a;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))}function w(t){return this instanceof w?(this.v=t,this):new w(t)}function v(t,e,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=o.apply(t,e||[]),a=[];return n={},l("next"),l("throw"),l("return"),n[Symbol.asyncIterator]=function(){return this},n;function l(t){r[t]&&(n[t]=function(e){return new Promise((function(o,n){a.push([t,e,o,n])>1||c(t,e)}))})}function c(t,e){try{(o=r[t](e)).value instanceof w?Promise.resolve(o.value.v).then(i,u):s(a[0][2],o)}catch(t){s(a[0][3],t)}var o}function i(t){c("next",t)}function u(t){c("throw",t)}function s(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}}function _(t){var e,o;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,r){e[n]=t[n]?function(e){return(o=!o)?{value:w(t[n](e)),done:"return"===n}:r?r(e):e}:r}}function k(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,o=t[Symbol.asyncIterator];return o?o.call(t):(t=b(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=t[o]&&function(e){return new Promise((function(n,r){!function(t,e,o,n){Promise.resolve(n).then((function(e){t({value:e,done:o})}),e)}(n,r,(e=t[o](e)).done,e.value)}))}}}function O(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function B(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&f(e,t,o);return E(e,t),e}function P(t){return t&&t.__esModule?t:{default:t}}function x(t,e,o,n){if("a"===o&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===o?n:"a"===o?n.call(t):n?n.value:e.get(t)}function I(t,e,o,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(t,o):r?r.value=o:e.set(t,o),o}function S(t,e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?e===t:t.has(e)}}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,o),a.exports}o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{o.d(n,{Z:()=>f});var t=o(122),e=o(890);const r=(t,e)=>{const o=document.createElement("button");o.id=t,o.className="bp3-button bp3-minimal rm-mobile-button dont-unfocus-block",o.style.padding="6px 4px 4px;";const n=document.createElement("span");return n.className=`bp3-icon bp3-icon-${e}`,n.style.cursor="pointer",n.style.color="rgb(92, 112, 128)",n.style.fontSize="18px",n.style.transform="scale(1.2)",n.style.fontWeight="1.8",n.style.margin="8px 4px",o.appendChild(n),o},a=t=>{document.querySelectorAll(`#${t}`).forEach((t=>{t.remove()}))};var l={menuItems:[],observers:[]};const c={tabTitle:"Mobile BottomBar Buttons",settings:[{id:"open-close",name:"Open Close Block Button",description:"Adds a button to toggle the selected block open/close",action:{type:"switch",onChange:t=>{console.log("Show Open Close Button",t.target.checked),t.target.checked||a(s)}}},{id:"smartblock-workflow",name:"Input test",description:"Adds a button to toggle a smartblock workflow. If nothing is entered a button will not be added",action:{type:"input",placeholder:"none",onChange:t=>{console.log("Smartblock Input Changed!",t.target.value);let e=t.target.value;0!==e.length&&e.trim()||a("bottomSmartblockButton")}}},{id:"bold-button",name:"Bold Button",description:"Adds a button to bold the selected text",action:{type:"switch",onChange:t=>{console.log("Show Bold Button",t.target.checked),t.target.checked?textFormatButton("bold"):a("formatBlockbold")}}},{id:"italic-button",name:"Italicize Button",description:"Adds a button to italicize the selected text",action:{type:"switch",onChange:t=>{console.log("Show Bold Button",t.target.checked),t.target.checked?textFormatButton("italic"):a("formatBlockitalic")}}},{id:"highlight-button",name:"Highlight Button",description:"Adds a button to highlight the selected text",action:{type:"switch",onChange:t=>{console.log("Show Bold Button",t.target.checked),t.target.checked?textFormatButton("highlight"):a("formatBlockhighlight")}}},{id:"button-order",name:"Button Locations",description:"NOT WORKING:Where in the bottom bar to start adding the buttons",action:{type:"select",items:["Main Bar","New Panel"],onChange:t=>{console.log("Select Changed!",t)}}}]},i="mobile-more-icon-button",u="mobile-back-icon-button",s="mobile-block-toggle-icon-button";let d;const f={onload:function({extensionAPI:o}){o.settings.panel.create(c);const n=r(i,"menu"),a=r(u,"arrow-left"),f=r("mobile-todo-icon-button","check-square"),p=r(s,"arrows-vertical"),b=((t,e)=>{const o=document.createElement("button");o.id="mobile-smartblock-button",o.className="bp3-button bp3-minimal rm-mobile-button dont-unfocus-block",o.style.padding="6px 4px 4px;";const n=document.createElement("img");return n.src="https://raw.githubusercontent.com/dvargas92495/roamjs-smartblocks/main/src/img/lego3blocks.png",n.alt="",n.width="15",o.appendChild(n),o})();n.onclick=()=>{const t=document.getElementById("rm-mobile-bar");l.menuItems=Array.from(t.children),Array.from(t.children).forEach((e=>t.removeChild(e))),o.settings.get("open-close")&&(t.appendChild(p),p.onclick=()=>{window.roamAlphaAPI.data.pull("[:block/open]",[":block/uid",roamAlphaAPI.ui.getFocusedBlock()["block-uid"]])[":block/open"]?roamAlphaAPI.updateBlock({block:{uid:roamAlphaAPI.ui.getFocusedBlock()["block-uid"],open:!1}}):roamAlphaAPI.updateBlock({block:{uid:roamAlphaAPI.ui.getFocusedBlock()["block-uid"],open:!0}})}),null!=o.settings.get("smartblock-workflow")&&(t.appendChild(b),b.onclick=()=>{(t=>{let e=t.settings.get("smartblock-workflow");try{window.roamjs.extension.smartblocks.triggerSmartblock({srcName:e,targetUid:roamAlphaAPI.ui.getFocusedBlock()["block-uid"]})}catch(t){console.error(t),alert("Smartblock Workflow does not exist")}})(o)}),t.appendChild(a)},a.onclick=()=>{const t=document.getElementById("rm-mobile-bar");Array.from(t.children).forEach((e=>t.removeChild(e))),l.menuItems.forEach((e=>t.appendChild(e)))},f.onclick=()=>{if("TEXTAREA"===d.tagName){const t=d,o=t.selectionStart,n=t.selectionEnd,r=t.value,a=TODO_REGEX.test(r)?r.replace(TODO_REGEX,"{{[[DONE]]}}"):DONE_REGEX.test(r)?r.replace(DONE_REGEX,""):`{{[[TODO]]}} ${r}`,l=a.length-r.length,{blockUid:c}=(0,e.Z)(t);window.roamAlphaAPI.updateBlock({block:{uid:c,string:a}}),(({id:t,start:e,end:o,focus:n})=>{window.setTimeout((()=>{const r=document.getElementById(t);n&&r.focus(),r.setSelectionRange(e,o)}),100)})({id:t.id,start:o+l,end:n+l})}};const m=(0,t.Z)((()=>{if(!document.getElementById(i)&&!document.getElementById(u)){const t=document.getElementById("rm-mobile-bar");t&&t.appendChild(n)}}));l.observers=[m],console.log("load mobile bottombar plugin")},onunload:function(){for(let t=0;t<l.observers.length;t++)l.observers[t].disconnect();if(document.getElementById(i))a(i);else if(document.getElementById(u)){const t=document.getElementById("rm-mobile-bar");Array.from(t.children).forEach((e=>t.removeChild(e))),l.menuItems.forEach((e=>t.appendChild(e)))}console.log("unload mobile bottombar plugin")}}})();var r=n.Z;export{r as default};